RETURN (
  FOR v_currentEntity1
  IN (
    FOR v_delivery1
    IN @@deliveries
    FILTER (v_delivery1._key == @var1)
    LIMIT @var2
    RETURN v_delivery1
  )
  UPDATE v_currentEntity1
  WITH {}
  IN @@deliveries
  OPTIONS { mergeObjects: false }
  RETURN NEW._key
)

// --------------------------------

RETURN (
  FOR v_from1 IN [CONCAT(@var1, FIRST(@v_updatedIds1))]
  FOR v_to1 IN @var2
  FOR v_edge1 IN @@deliveries_handlingUnits
  FILTER v_edge1._from == v_from1 && v_edge1._to == v_to1
  REMOVE v_edge1 IN @@deliveries_handlingUnits
)

// --------------------------------

WITH @@deliveries
LET v_delivery1 = DOCUMENT(@@deliveries, @var1)
RETURN (IS_NULL(v_delivery1) ? null : {
  "deliveryNumber": v_delivery1.`deliveryNumber`
})

// --------------------------------

WITH @@deliveries
RETURN {
  "logistics": {
    "delivery": {
      "updateDelivery": @v_updateDelivery1
    }
  }
}
