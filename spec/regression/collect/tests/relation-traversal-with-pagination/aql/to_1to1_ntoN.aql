WITH @@deliveries, @@handlingUnits
LET v_order1 = FIRST((
  FOR v_order2
  IN @@orders
  FILTER (v_order2.`orderNumber` == @var1)
  LIMIT @var2
  RETURN v_order2
))
RETURN {
  "Order": (IS_NULL(v_order1) ? null : {
    "allOuterHandlingUnits": (
      FOR v_node1, v_edge1, v_path1 IN @var3..@var4 INBOUND v_order1 @@deliveries_order
      FOR v_node2, v_edge2, v_path2 IN @var5..@var6 OUTBOUND v_node1 @@deliveries_handlingUnits
      FILTER v_node2._key != null
      SORT (v_node2.`handlingUnitNumber`)
      LIMIT @var7, @var8
      RETURN {
        "number": v_node2.`handlingUnitNumber`
      }
    )
  })
}

// Peak memory usage: 65536 bytes
