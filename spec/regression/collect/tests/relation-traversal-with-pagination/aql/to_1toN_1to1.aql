WITH @@deliveries, @@orders
LET v_shipment1 = FIRST((
  FOR v_shipment2
  IN @@shipments
  FILTER (v_shipment2.`shipmentNumber` == @var1)
  LIMIT @var2
  RETURN v_shipment2
))
RETURN {
  "Shipment": (IS_NULL(v_shipment1) ? null : {
    "allOrders": (
      FOR v_order1
      IN (
        FOR v_item1
        IN (
          FOR v_node1, v_edge1, v_path1 IN @var3..@var4 OUTBOUND v_shipment1 @@shipments_deliveries
          FOR v_node2, v_edge2, v_path2 IN @var5..@var6 OUTBOUND v_node1 @@deliveries_order
          RETURN v_node2
        )
        FILTER v_item1 != null
        COLLECT v_distinct1 = v_item1
        RETURN v_distinct1
      )
      SORT (v_order1.`orderNumber`)
      LIMIT @var7, @var8
      RETURN {
        "number": v_order1.`orderNumber`
      }
    )
  })
}

// Peak memory usage: 98304 bytes
