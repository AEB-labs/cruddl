WITH @@deliveries, @@handlingUnits
LET v_order1 = FIRST((
  FOR v_order2
  IN (
    FOR v_item1
    IN @@orders
    FILTER (v_item1.`accessGroup` IN @var1)
    RETURN v_item1
  )
  FILTER (v_order2.`orderNumber` == @var2)
  LIMIT @var3
  RETURN v_order2
))
RETURN {
  "Order": (IS_NULL(v_order1) ? null : {
    "allOuterHandlingUnits": (
      FOR v_handlingUnit1
      IN (
        LET v_nullableNode1 = FIRST(FOR v_node1, v_edge1, v_path1 IN @var4..@var5 INBOUND v_order1 @@deliveries_order
        FILTER (v_node1.`accessGroup` IN @var6) FILTER v_node1 != null RETURN v_node1)
        FOR v_node2, v_edge2, v_path2 IN @var7..@var8 OUTBOUND v_nullableNode1 @@deliveries_handlingUnits
        FILTER (v_node2.`accessGroup` IN @var9)
        FILTER v_node2._key != null
        RETURN v_node2
      )
      SORT (v_handlingUnit1.`handlingUnitNumber`)
      RETURN {
        "number": v_handlingUnit1.`handlingUnitNumber`
      }
    )
  })
}

// Peak memory usage: 98304 bytes
