RETURN {
  "allDeliveries": (
    FOR v_delivery1
    IN @@deliveries
    SORT (v_delivery1.`updatedAt`)  DESC
    LIMIT @var1
    LET v_country1 = (IS_NULL(v_delivery1.`consignee`.`country`) ? null : FIRST((
      FOR v_country2
      IN @@countries
      FILTER ((v_country2.`isoCode` > NULL) && (v_country2.`isoCode` == v_delivery1.`consignee`.`country`))
      LIMIT @var2
      RETURN v_country2
    )))
    LET v_country3 = (IS_NULL(v_delivery1.`destinationCountryISOCode`) ? null : FIRST((
      FOR v_destinationCountry1
      IN @@countries
      FILTER ((v_destinationCountry1.`isoCode` > NULL) && (v_destinationCountry1.`isoCode` == v_delivery1.`destinationCountryISOCode`))
      LIMIT @var3
      RETURN v_destinationCountry1
    )))
    RETURN {
      "deliveryNumber": v_delivery1.`deliveryNumber`,
      "consignee": (IS_NULL(v_delivery1.`consignee`) ? null : {
        "city": v_delivery1.`consignee`.`city`,
        "country": (IS_NULL(v_country1) ? null : {
          "isoCode": v_country1.`isoCode`,
          "description": (
            FOR v_translation1
            IN (IS_LIST(v_country1.`description`) ? v_country1.`description` : [])
            RETURN {
              "languageIsoCode": v_translation1.`languageIsoCode`,
              "translation": v_translation1.`translation`
            }
          )
        }),
        "street": v_delivery1.`consignee`.`street`
      }),
      "contentInfo": (
        FOR v_translation2
        IN (IS_LIST(v_delivery1.`contentInfo`) ? v_delivery1.`contentInfo` : [])
        RETURN {
          "translation": v_translation2.`translation`,
          "languageIsoCode": v_translation2.`languageIsoCode`
        }
      ),
      "destinationCountry": (IS_NULL(v_country3) ? null : {
        "isoCode": v_country3.`isoCode`
      }),
      "dgInfo": {
        "flashpoint": v_delivery1.`dgInfo`.`flashpoint`,
        "unNumber": v_delivery1.`dgInfo`.`unNumber`,
        "notices": (IS_LIST(v_delivery1.`dgInfo`.`notices`) ? v_delivery1.`dgInfo`.`notices` : [])
      },
      "serialNumbers": (IS_LIST(v_delivery1.`serialNumbers`) ? v_delivery1.`serialNumbers` : []),
      "items": (
        FOR v_deliveryItem1
        IN (IS_LIST(v_delivery1.`items`) ? v_delivery1.`items` : [])
        RETURN {
          "itemNumber": v_deliveryItem1.`itemNumber`
        }
      )
    }
  )
}

// Peak memory usage: 196608 bytes
