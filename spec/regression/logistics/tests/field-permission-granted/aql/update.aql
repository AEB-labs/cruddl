RETURN (
  FOR v_currentEntity1
  IN (
    FOR v_delivery1
    IN @@deliveries
    FILTER (v_delivery1._key == @var1)
    LIMIT @var2
    RETURN v_delivery1
  )
  UPDATE v_currentEntity1
  WITH {
    "totalValue": @var3,
    "updatedAt": @var4
  }
  IN @@deliveries
  OPTIONS { mergeObjects: false }
  RETURN NEW._key
)

// Peak memory usage: 32768 bytes

// ----------------------------------------------------------------

WITH @@deliveries
LET v_delivery1 = DOCUMENT(@@deliveries, @var1)
RETURN (IS_NULL(v_delivery1) ? null : {
  "deliveryNumber": v_delivery1.`deliveryNumber`
})

// Peak memory usage: 0 bytes

// ----------------------------------------------------------------

WITH @@deliveries
RETURN (
  FOR v_currentEntity1
  IN (
    FOR v_forwarder1
    IN @@forwarders
    FILTER (v_forwarder1._key == @var1)
    LIMIT @var2
    RETURN v_forwarder1
  )
  UPDATE v_currentEntity1
  WITH {
    "name": @var3,
    "updatedAt": @var4
  }
  IN @@forwarders
  OPTIONS { mergeObjects: false }
  RETURN NEW._key
)

// Peak memory usage: 32768 bytes

// ----------------------------------------------------------------

WITH @@deliveries, @@forwarders
LET v_forwarder1 = DOCUMENT(@@forwarders, @var1)
RETURN (IS_NULL(v_forwarder1) ? null : {
  "name": v_forwarder1.`name`
})

// Peak memory usage: 0 bytes

// ----------------------------------------------------------------

WITH @@deliveries, @@forwarders
RETURN (
  FOR v_currentEntity1
  IN (
    FOR v_delivery1
    IN @@deliveries
    FILTER (v_delivery1._key == @var1)
    LIMIT @var2
    RETURN v_delivery1
  )
  UPDATE v_currentEntity1
  WITH {
    "deliveryNumber": @var3,
    "updatedAt": @var4
  }
  IN @@deliveries
  OPTIONS { mergeObjects: false }
  RETURN NEW._key
)

// Peak memory usage: 32768 bytes

// ----------------------------------------------------------------

WITH @@deliveries, @@forwarders
LET v_entity1 = DOCUMENT(@@deliveries, FIRST(@v_updatedIds1))
RETURN (
  UPSERT {
              key: @var1,
              type: @var2
          }
  INSERT {

          key: @var3,
          type: @var4,
          category: null,
          quantity: null,
          isExported: false,
          createdAt: @var5,
          updatedAt: @var6,
              isConfirmedForExport: false
           }
  UPDATE (OLD.isConfirmedForExport ? {} : {
              updatedAt: @var7,
              category: null,
              quantity: null
          })
  IN @@billingEntities
  RETURN @var8
)

// Peak memory usage: 65536 bytes

// ----------------------------------------------------------------

WITH @@deliveries, @@forwarders
LET v_delivery1 = DOCUMENT(@@deliveries, @var1)
RETURN (IS_NULL(v_delivery1) ? null : {
  "deliveryNumber": v_delivery1.`deliveryNumber`
})

// Peak memory usage: 0 bytes

// ----------------------------------------------------------------

WITH @@deliveries, @@forwarders
RETURN {
  "updateDelivery": @v_updateDelivery1,
  "updateForwarder": @v_updateForwarder1,
  "update2": @v_updateDelivery2
}

// Peak memory usage: 0 bytes
