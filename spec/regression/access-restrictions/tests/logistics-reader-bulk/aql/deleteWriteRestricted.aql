RETURN (FIRST(
  FOR v_item1
  IN (
    FOR v_file1
    IN (
      FOR v_file2
      IN (
        FOR v_item2
        IN @@files
        FILTER ((v_item2.`accessGroup` == @var1) || (v_item2.`accessGroup` == @var2))
        RETURN v_item2
      )
      FILTER (v_file2._key == @var3)
      RETURN v_file2
    )
    FILTER !((v_file1.`accessGroup` == @var4))
    RETURN v_file1
  )
  COLLECT WITH COUNT INTO v_count1
  RETURN v_count1
) == 0)

// Peak memory usage: 0 bytes

// ----------------------------------------------------------------

RETURN (
  FOR v_file1
  IN (
    FOR v_file2
    IN (
      FOR v_item1
      IN @@files
      FILTER ((v_item1.`accessGroup` == @var1) || (v_item1.`accessGroup` == @var2))
      RETURN v_item1
    )
    FILTER (v_file2._key == @var3)
    REMOVE v_file2
    IN @@files
    RETURN OLD
  )
  RETURN {
    "name": v_file1.`name`
  }
)

// ----------------------------------------------------------------

RETURN {
  "deleteAllFiles": @v_deleteAllFiles1
}
