RETURN {
  "allRoots": (
    FOR v_root1
    IN @@roots
    SORT (v_root1.`name`)
    RETURN {
      "name": v_root1.`name`,
      "children": (
        LET v_root2 = NOEVAL({
          "name": v_root1.`name`
        })
        FOR v_child1
        IN v_root1.`children`[*]
        RETURN {
          "name": v_child1.`name`,
          "children": v_child1.`children`[* RETURN {
            "name": CURRENT.`name`,
            "parent": {
              "name": v_child1.`name`,
              "parent": {
                "name": v_root1.`name`
              },
              "children": v_child1.`children`[* RETURN {
                "name": CURRENT.`name`,
                "parent": {
                  "name": v_child1.`name`,
                  "parent": {
                    "name": v_root1.`name`
                  }
                }
              }]
            },
            "root": {
              "name": v_root1.`name`
            }
          }],
          "parent": {
            "name": v_root1.`name`
          },
          "root": v_root2
        }
      )
    }
  )
}

// Peak memory usage: 360448 bytes
