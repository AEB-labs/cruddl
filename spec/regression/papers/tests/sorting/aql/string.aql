WITH @@users
RETURN {
  "allPapers": (
    FOR v_paper1
    IN @@papers
    SORT (v_paper1.`title`)
    RETURN {
      "title": v_paper1.`title`,
      "readers": (
        FOR v_user1
        IN INBOUND v_paper1 @@users_papers
        FILTER v_user1._key != null
        SORT (v_user1.`firstName`)  DESC
        RETURN {
          "firstName": v_user1.`firstName`
        }
      )
    }
  )
}

// Peak memory usage: 98304 bytes
